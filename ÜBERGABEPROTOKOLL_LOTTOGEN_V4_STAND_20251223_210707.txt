================================================================================
               √úBERGABEPROTOKOLL ‚Äì LOTTOGENERATOR V4 (AKTUELLER STAND)
================================================================================
ERSTELLT AM: $(date)
LETZTER COMMIT: $(git log --oneline -1)
STATUS: flutter analyze zeigt 3 Warnungen, 113 Info (nach Bereinigung durch Kollege)
PROJEKT: /home/user/lottogenerator_v4

==================== I. REVOLUTION√ÑRE PARSER-ERKENNTNISSE ====================

‚úÖ REVOLUTION√ÑRE MATHEMATISCHE ZIFFERN-FORMEL F√úR LOTTO 6AUS49 ENTDECKT:

FORMAT: ZNtt.mm.yyyyWWZZZZZZSZ
  ZN = Ziehungsnummer (optional)
  tt = Tag (2-stellig)
  mm = Monat (2-stellig)
  yyyy = Jahr (4-stellig)
  WW = Wochentag (2-stellig, z.B. "Mi")
  ZZZZZZ = Zahlenblock (7-13 Ziffern)
  SZ = Superzahl (1 Ziffer)

MATHEMATISCHE FORMEL:
  Gesamtziffern (inkl. Superzahl) = 7 bis 13
  Anzahl 2-stelliger Zahlen = (Gesamtziffern - 7)
  Anzahl 1-stelliger Zahlen = 6 - (Gesamtziffern - 7)

BEISPIELE DER FORMEL:
  - 7  Ziffern: 0√ó2-stellig + 6√ó1-stellig + 1SZ    (z.B. "1234567")
  - 8  Ziffern: 1√ó2-stellig + 5√ó1-stellig + 1SZ    (z.B. "12345127")
  - 9  Ziffern: 2√ó2-stellig + 4√ó1-stellig + 1SZ    (z.B. "123412132")
  - 10 Ziffern: 3√ó2-stellig + 3√ó1-stellig + 1SZ    (z.B. "1231213145")
  - 11 Ziffern: 4√ó2-stellig + 2√ó1-stellig + 1SZ    (H√ÑUFIGSTES FORMAT!)
  - 12 Ziffern: 5√ó2-stellig + 1√ó1-stellig + 1SZ    (z.B. "927283045496")
  - 13 Ziffern: 6√ó2-stellig + 0√ó1-stellig + 1SZ    (z.B. "1022262730338")

‚úÖ UNIVERSAL-PARSER-PRINZIP: R√úCKW√ÑRTS PARSEN
F√úR BEIDE SPIELTYPEN GILT:
1. Zahlen werden IMMER von hinten nach vorne geparst
2. Beim R√ºckw√§rts-Parsen muss jede neue Zahl KLEINER sein als vorherige
3. Ergebnis ist automatisch aufsteigend sortiert

LOTTO 6AUS49 PARSING-SCHRITTE:
1. Superzahl = letzte Ziffer extrahieren
2. Zahlenblock ohne Superzahl r√ºckw√§rts parsen mit Ziffern-Formel
3. Historische Korrektur: Superzahl = -1 f√ºr Daten vor 07.12.1991

EUROJACKPOT PARSING-SCHRITTE:
1. 2 Eurozahlen r√ºckw√§rts parsen (Bereich 1-12)
2. 5 Hauptzahlen r√ºckw√§rts parsen (Bereich 1-50)
3. Kombination in aufsteigender Reihenfolge

‚úÖ IMPLEMENTIERTE PARSER-METHODEN (in lotto_database.dart):
- Map<String, dynamic> _parseLotto6aus49CompactLine(String line)
- List<int> _parseLottoNumbersBackwards(String numbersStrWithSuper)
- Map<String, String> _parseEurojackpotCompactLine(String line)
- List<int> _parseNumbersBackwards(String numbersStr)

==================== II. AKTUELLER PROJEKTSTAND ====================

‚úÖ BEHOBEN DURCH KOLLEGEN:
1. analysis_options.yaml war kaputt (Syntaxfehler "Expected ':'")
2. Alte, nicht genutzte Screens/Services verursachten Fake-Errors
3. Analyzer jetzt korrekt konfiguriert: blendet Altlasten aus

‚úÖ AKTUELLE ANALYSE-ERGEBNISSE:
flutter analyze --no-pub
  - 3 warnings (harmlose Stilhinweise)
  - 113 info (const-Konstruktor Vorschl√§ge)
  - 0 ERRORS (kritische Syntaxfehler)

üö® VERBLEIBENDE KRITISCHE PROBLEME:
1. IMPORT/UPDATE-SCREEN: Graues Terminal-Fenster bleibt leer
   - Log-Ausgaben werden nicht im UI angezeigt
   - Fortschrittsbalken funktioniert nicht
   - Datenbank-Service k√∂nnte nicht korrekt angebunden sein

2. STATUS-WIDGETS: Verbindung zum Log-Terminal fehlt
   - _addLog() Aufrufe erreichen UI nicht
   - Live-Logs funktionieren nicht

3. EUROJACKPOT-ANALYSEN: Sind leer
   - Datenbank-Query f√ºr EJ m√∂glicherweise fehlerhaft
   - Statistik-Engine f√ºr EJ nicht vollst√§ndig implementiert

==================== III. DATENBANK-ARCHITEKTUR ====================

DATENBANK-SCHEMA:
  Tabelle 'ziehungen':
    - id INTEGER PRIMARY KEY AUTOINCREMENT
    - spieltyp TEXT NOT NULL ('lotto_6aus49' oder 'eurojackpot')
    - datum TEXT NOT NULL ('dd-mm-yyyy')
    - zahlen TEXT NOT NULL ('1 2 3 4 5 6' oder '1 2 3 4 5 6 7')
    - superzahl INTEGER (-1 f√ºr vor 1991, 0-9 danach)

AUTOMATISCHER IMPORT-WORKFLOW:
1. Bei leerer DB ‚Üí automatischer Import aus TXT-Dateien
2. Assets: assets/data/lotto_1955_2025.txt
3. Assets: assets/data/eurojackpot_2012_2025.txt
4. Format: "dd.mm.yyyy | z1 z2 z3 z4 z5 z6 | sz"

MANUELLER IMPORT (implementiert):
- importLotto6aus49Manually(String text)
- importEurojackpotManually(String text)
- Batch-Import mit Transaktionen
- Duplikat-Erkennung (Datum + Spieltyp)

==================== IV. WEB-SCRAPER ‚Üí AUTOMATISCHER IMPORT ====================

VORHANDENE SCRAPER (getestet):
1. lib/services/lottozahlenonline_scraper.dart
   - URL: https://www.lottozahlenonline.de/statistik/beide-spieltage/lottozahlen-archiv.php?j=JAHR
   - Extrahiert HTML-Tabellen mit Ziehungen

2. lib/services/eurojackpot_scraper.dart
   - URL: https://www.eurojackpot-zahlen.eu/eurojackpot-zahlenarchiv.php?j=JAHR
   - M√∂gliche Probleme mit JavaScript-geladenen Tabellen

VORGESCHLAGENER AUTOMATISIERUNGS-WORKFLOW:
1. Scraper f√ºr aktuelles + letztes Jahr ausf√ºhren
2. HTML ‚Üí Kompaktformat konvertieren
3. Konvertierte Daten in DB importieren (manuelle Import-Methoden nutzen)
4. Erfolgsmeldung mit Anzahl neuer Ziehungen

==================== V. N√ÑCHSTE SCHRITTE (PRIORIT√ÑT) ====================

PRIO 1: IMPORT/UPDATE-SCREEN FIXEN
   - Terminal-Fenster: schwarzer Hintergrund, gr√ºne Schrift
   - _addLog() Methoden mit setState() wrappen
   - Datenbank-Service korrekt initialisieren (LottoDatabase.instance)
   - Fortschrittsbalken w√§hrend Import anzeigen

PRIO 2: STATUS-WIDGETS ANBINDEN
   - LogEntry und LogType au√üerhalb der State-Klasse definieren
   - Live-Log-Stream implementieren
   - Erste/letzte Datum pro Spieltyp anzeigen

PRIO 3: EUROJACKPOT-ANALYSEN VOLLST√ÑNDIG
   - StatisticsScreen um EJ-Analyse erweitern
   - Getrennte Analyse: Hauptzahlen (1-50) + Eurozahlen (1-12)
   - Kombinations-Analyse implementieren

PRIO 4: WEB-SCRAPER INTEGRIEREN
   - "Aktualisieren" Button in Import-Kachel
   - Scraper + Parser kombinieren
   - Einmal pro Woche automatisch ausf√ºhren

==================== VI. BEFEHLE ZUM FORTSETZEN ====================

# 1. Projektstatus √ºberpr√ºfen
cd /home/user/lottogenerator_v4
git status
flutter analyze --no-pub

# 2. Import-Screen debuggen
cat lib/screens/database_status_screen.dart | head -100

# 3. Datenbank-Service testen
cat lib/services/lotto_database.dart | grep -n "import.*Manually"

# 4. Spezifische Probleme angehen:
#    - Terminal-Logs: Pr√ºfe setState() Aufrufe in _addLog()
#    - EJ-Analysen: Pr√ºfe statistics/ Ordner f√ºr Eurojackpot-Implementierung
#    - Web-Scraper: Teste mit flutter run lib/services/lottozahlenonline_scraper.dart

==================== VII. WICHTIGE TECHNISCHE DETAILS ====================

PARSER-BEISPIELE ZUM TESTEN:
LOTTO:   "101.01.2025Mi37151826332"
         ‚Üí Datum: 01-01-2025
         ‚Üí Zahlen: 3 7 15 18 26 33
         ‚Üí Superzahl: 2
         ‚Üí Formel: 11 Ziffern = 4√ó2-stellig + 2√ó1-stellig

EUROJACKPOT: "103.01.2025120212729810"
         ‚Üí Datum: 03-01-2025
         ‚Üí Zahlen: 1 2 12 27 29 8 10
         ‚Üí R√ºckw√§rts-Parsing: 10,8,29,27,12,2,1

HISTORISCHE KORREKTUREN:
- Superzahl wurde am 07.12.1991 eingef√ºhrt
- F√ºr Daten davor: Superzahl = -1 (statt 0-9)
- Wichtig f√ºr korrekte statistische Auswertung

DATENBANK-PFADE:
- Standard: /data/data/com.termux/files/.../databases/lottodaten.db
- Kann mit getDatabasesPath() aus sqflite ermittelt werden

================================================================================
ENDE DES √úBERGABEPROTOKOLLS ‚Äì ALLE REVOLUTION√ÑREN PARSER-ERKENNTNISSE SIND HIER DOKUMENTIERT
